<!DOCTYPE html>
<html>
  <head>
    <title>You're in control</title>
    <link rel="stylesheet" href="css/sequencer.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
  </head>
  <body>
    <div id="form-container">
      
        <div id="intro-div">
          <span id="disconnect-message"></span>
          <form id="intro" action="track" method="get">
            <table id="intro-form-table">
              <tr>
                <td><label for="initials">Enter your initials:</label></td>
                <td><input type="text" class="intro-form" name="initials" id="initials" maxlength="3" placeholder="---" style="text-transform:uppercase"/></td>
              </tr>
              <tr>
                <td><label for="room" class="intro-room-hide">Room to join:</label></td>
                <td><input type="text" class="intro-form intro-room-hide" name="room" id="room" /></td>
              </tr>
              <tr>
                <td colspan="2" id="button-cel">
                  <button id="go" class="ui-button" value="Go!">Go!</button>
                </td>
              </tr>
            </table>
          </form>
        </div>
      
    </div>
    <script src="scripts/config.js"></script>
    <script src="scripts/include.js"></script>
    <script>
      var initials = getCookie("initials");
      var initialsElem = document.getElementById("initials");
      initialsElem.value = initials;
      initialsElem.addEventListener("keyup", function (e) {
        this.value = this.value.toUpperCase();
      });

      var room = findGetParameter("room");
      if(!room) document.querySelectorAll(".intro-room-hide").forEach(elem => {
        elem.style.display = "block";
      });

      document.getElementById("room").value = room;

      var reason = findGetParameter("exitreason");
      if(reason && reason != "")
        document.getElementById("disconnect-message").innerText = reason;
      
      var form = document.getElementById("intro");
      document.getElementById("go").addEventListener("click", function(e){
        var initialsValue = initialsElem.value;
        console.log(document.querySelector("#room").value)
        console.log(initialsValue);
        if(initialsValue != "?" && initialsValue != "")
          setCookie("initials",initialsValue);
        form.submit();
      });
    </script>
  </body>
</html>